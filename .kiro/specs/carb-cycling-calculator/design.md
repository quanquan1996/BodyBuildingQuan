# Design Document: ç¢³å¾ªç¯å‡è„‚è®¡ç®—å™¨

## Overview

ç¢³å¾ªç¯å‡è„‚è®¡ç®—å™¨æ˜¯ä¸€ä¸ªåŸºäº Katch-McArdle å…¬å¼çš„è¥å…»è§„åˆ’å·¥å…·ï¼Œå¸®åŠ©ç”¨æˆ·åˆ¶å®šç§‘å­¦çš„ç¢³æ°´åŒ–åˆç‰©å¾ªç¯é¥®é£Ÿè®¡åˆ’ã€‚å·¥å…·æä¾›ç®€æ˜“ç‰ˆï¼ˆé«˜ç¢³/ä½ç¢³ï¼‰å’Œè¿›é˜¶ç‰ˆï¼ˆé«˜ç¢³/ä¸­ç¢³/ä½ç¢³ï¼‰ä¸¤ç§æ¨¡å¼ï¼Œè®¡ç®—æ¯æ—¥çƒ­é‡å’Œå®é‡è¥å…»ç´ åˆ†é…ã€‚

## Architecture

### æŠ€æœ¯æ ˆ
- Next.js 15 (App Router) + TypeScript
- React 19 å®¢æˆ·ç«¯ç»„ä»¶
- Tailwind CSS + shadcn/ui ç»„ä»¶åº“
- éµå¾ªç°æœ‰é¡¹ç›®çš„æ–‡ä»¶ç»“æ„å’Œä»£ç é£æ ¼

### æ–‡ä»¶ç»“æ„

```
nextjs-app/src/
â”œâ”€â”€ app/tools/carb-cycling-calculator/
â”‚   â””â”€â”€ page.tsx                    # é¡µé¢å…¥å£
â”œâ”€â”€ components/carb-cycling-calculator/
â”‚   â”œâ”€â”€ carb-cycling-form.tsx       # è¾“å…¥è¡¨å•
â”‚   â”œâ”€â”€ carb-cycling-result.tsx     # ç»“æœå±•ç¤º
â”‚   â”œâ”€â”€ carb-cycling-reference.tsx  # å‚è€ƒä¿¡æ¯
â”‚   â””â”€â”€ carb-cycling-explanation.tsx # åŸç†è¯´æ˜
â””â”€â”€ lib/utils/
    â””â”€â”€ carb-cycling.ts             # è®¡ç®—é€»è¾‘
```

## Components and Interfaces

### 1. è®¡ç®—é€»è¾‘æ¨¡å— (`carb-cycling.ts`)

```typescript
// è®¡ç®—æ¨¡å¼
type CarbCyclingMode = 'simple' | 'advanced';

// è¾“å…¥å‚æ•°
interface CarbCyclingInput {
  mode: CarbCyclingMode;
  weightKg: number;
  bodyFatPercent: number;
  activityLevel: ActivityLevel;
}

// å•æ—¥è¥å…»æ–¹æ¡ˆ
interface DayPlan {
  dayType: 'high' | 'medium' | 'low';
  label: string;
  calories: number;
  protein: number;      // å…‹
  carbs: number;        // å…‹
  fat: number;          // å…‹
  proteinPercent: number;
  carbsPercent: number;
  fatPercent: number;
}

// è®¡ç®—è¾“å‡º
interface CarbCyclingOutput {
  bmr: number;
  tdee: number;
  leanMass: number;
  mode: CarbCyclingMode;
  dayPlans: DayPlan[];
  weeklyAverage: number;
  weekSchedule: WeekSchedule;
}

// å‘¨è®¡åˆ’
interface WeekSchedule {
  simple: { highDays: number; lowDays: number };
  advanced: { highDays: number; mediumDays: number; lowDays: number };
}
```

### 2. è¡¨å•ç»„ä»¶ (`carb-cycling-form.tsx`)

åŠŸèƒ½ï¼š
- æ¨¡å¼åˆ‡æ¢ï¼ˆç®€æ˜“ç‰ˆ/è¿›é˜¶ç‰ˆï¼‰
- ä½“é‡è¾“å…¥ï¼ˆ30-300 kgï¼‰
- ä½“è„‚ç‡è¾“å…¥ï¼ˆ3-60%ï¼‰
- æ´»åŠ¨æ°´å¹³é€‰æ‹©ï¼ˆå¤ç”¨ç°æœ‰ `activityLevelLabels`ï¼‰
- è¡¨å•éªŒè¯å’Œé”™è¯¯æç¤º

UI è®¾è®¡ï¼š
- ä½¿ç”¨ Card ç»„ä»¶åŒ…è£¹
- æ¨¡å¼åˆ‡æ¢ä½¿ç”¨åŒæŒ‰é’®æ ·å¼
- è¾“å…¥æ¡†å¸¦å•ä½åç¼€
- æ´»åŠ¨æ°´å¹³ä½¿ç”¨å¯é€‰æŒ‰é’®åˆ—è¡¨

### 3. ç»“æœç»„ä»¶ (`carb-cycling-result.tsx`)

åŠŸèƒ½ï¼š
- æ˜¾ç¤º BMRã€TDEEã€ç˜¦ä½“é‡
- åˆ†å¡ç‰‡å±•ç¤ºå„æ—¥æœŸç±»å‹çš„è¥å…»æ–¹æ¡ˆ
- æ˜¾ç¤ºå®é‡è¥å…»ç´ ç™¾åˆ†æ¯”
- æ˜¾ç¤ºå‘¨å¹³å‡çƒ­é‡

UI è®¾è®¡ï¼š
- é«˜ç¢³æ—¥ï¼šç»¿è‰²ä¸»é¢˜ (`bg-green-500/10`, `text-green-600`)
- ä¸­ç¢³æ—¥ï¼šè“è‰²ä¸»é¢˜ (`bg-blue-500/10`, `text-blue-600`)
- ä½ç¢³æ—¥ï¼šæ©™è‰²ä¸»é¢˜ (`bg-orange-500/10`, `text-orange-600`)
- æ¯ä¸ªæ—¥æœŸå¡ç‰‡æ˜¾ç¤ºï¼šçƒ­é‡ã€è›‹ç™½è´¨ã€ç¢³æ°´ã€è„‚è‚ª

### 4. å‚è€ƒä¿¡æ¯ç»„ä»¶ (`carb-cycling-reference.tsx`)

å†…å®¹ï¼š
- å‘¨è®¡åˆ’å®‰æ’å»ºè®®è¡¨æ ¼
- å„æ—¥æœŸç±»å‹é€‚åˆçš„è®­ç»ƒå®‰æ’
- ç¢³å¾ªç¯æ‰§è¡Œè¦ç‚¹

### 5. è¯´æ˜ç»„ä»¶ (`carb-cycling-explanation.tsx`)

å†…å®¹ï¼š
- ç¢³å¾ªç¯åŸç†ä»‹ç»
- Katch-McArdle å…¬å¼è¯´æ˜
- å¸¸è§é—®é¢˜è§£ç­”

## Data Models

### çƒ­é‡åˆ†é…æ¯”ä¾‹

| æ—¥æœŸç±»å‹ | ç®€æ˜“ç‰ˆ | è¿›é˜¶ç‰ˆ |
|---------|--------|--------|
| é«˜ç¢³æ—¥ | 100% TDEE | 110% TDEE |
| ä¸­ç¢³æ—¥ | - | 100% TDEE |
| ä½ç¢³æ—¥ | 80% TDEE | 80% TDEE |

### å®é‡è¥å…»ç´ åˆ†é…

| è¥å…»ç´  | é«˜ç¢³æ—¥ | ä¸­ç¢³æ—¥ | ä½ç¢³æ—¥ |
|--------|--------|--------|--------|
| è›‹ç™½è´¨ | 2.0g/kg | 2.0g/kg | 2.2g/kg |
| ç¢³æ°´ | 50% çƒ­é‡ | 35% çƒ­é‡ | 20% çƒ­é‡ |
| è„‚è‚ª | å‰©ä½™çƒ­é‡ | å‰©ä½™çƒ­é‡ | å‰©ä½™çƒ­é‡ |

### å‘¨è®¡åˆ’å»ºè®®

**ç®€æ˜“ç‰ˆï¼ˆ2é«˜5ä½ï¼‰ï¼š**
- é«˜ç¢³æ—¥ï¼šå‘¨ä¸‰ã€å‘¨å…­ï¼ˆè®­ç»ƒæ—¥ï¼‰
- ä½ç¢³æ—¥ï¼šå…¶ä½™5å¤©

**è¿›é˜¶ç‰ˆï¼ˆ2é«˜2ä¸­3ä½ï¼‰ï¼š**
- é«˜ç¢³æ—¥ï¼šå‘¨ä¸‰ã€å‘¨å…­ï¼ˆé«˜å¼ºåº¦è®­ç»ƒï¼‰
- ä¸­ç¢³æ—¥ï¼šå‘¨ä¸€ã€å‘¨äº”ï¼ˆä¸­ç­‰è®­ç»ƒï¼‰
- ä½ç¢³æ—¥ï¼šå‘¨äºŒã€å‘¨å››ã€å‘¨æ—¥ï¼ˆä¼‘æ¯/è½»åº¦ï¼‰

### è®¡ç®—å…¬å¼

```typescript
// 1. ç˜¦ä½“é‡
leanMass = weightKg * (1 - bodyFatPercent / 100)

// 2. BMR (Katch-McArdle)
bmr = 370 + 21.6 * leanMass

// 3. TDEE
tdee = bmr * activityMultiplier

// 4. è›‹ç™½è´¨ï¼ˆå›ºå®šï¼‰
protein = weightKg * proteinPerKg  // 2.0-2.2g/kg

// 5. ç¢³æ°´ï¼ˆæŒ‰çƒ­é‡ç™¾åˆ†æ¯”ï¼‰
carbCalories = dayCalories * carbPercent
carbs = carbCalories / 4

// 6. è„‚è‚ªï¼ˆå‰©ä½™çƒ­é‡ï¼‰
fatCalories = dayCalories - (protein * 4) - (carbs * 4)
fat = fatCalories / 9
// ç¡®ä¿è„‚è‚ªä¸ä½äº 0.8g/kg
fat = Math.max(fat, weightKg * 0.8)
```

## Error Handling

### è¾“å…¥éªŒè¯

| å­—æ®µ | éªŒè¯è§„åˆ™ | é”™è¯¯ä¿¡æ¯ |
|------|---------|---------|
| ä½“é‡ | 30-300 kg | è¯·è¾“å…¥æœ‰æ•ˆä½“é‡ (30-300 kg) |
| ä½“è„‚ç‡ | 3-60% | è¯·è¾“å…¥æœ‰æ•ˆä½“è„‚ç‡ (3-60%) |

### è¾¹ç•Œæƒ…å†µ

1. **è„‚è‚ªè¿‡ä½**ï¼šå½“è®¡ç®—å‡ºçš„è„‚è‚ªä½äº 0.8g/kg æ—¶ï¼Œè‡ªåŠ¨è°ƒæ•´ä¸ºæœ€ä½å€¼
2. **çƒ­é‡è¿‡ä½**ï¼šå½“ä½ç¢³æ—¥çƒ­é‡ä½äº BMR æ—¶ï¼Œæ˜¾ç¤ºè­¦å‘Šæç¤º

## Testing Strategy

### å•å…ƒæµ‹è¯•
- æµ‹è¯• Katch-McArdle å…¬å¼è®¡ç®—å‡†ç¡®æ€§
- æµ‹è¯•å®é‡è¥å…»ç´ åˆ†é…é€»è¾‘
- æµ‹è¯•è¾“å…¥éªŒè¯å‡½æ•°

### é›†æˆæµ‹è¯•
- æµ‹è¯•è¡¨å•æäº¤å’Œç»“æœæ˜¾ç¤ºæµç¨‹
- æµ‹è¯•æ¨¡å¼åˆ‡æ¢åŠŸèƒ½

## UI/UX è®¾è®¡

### é¡µé¢å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Hero Section                      â”‚
â”‚         ç¢³å¾ªç¯å‡è„‚è®¡ç®—å™¨ Â· ç§‘å­¦è§„åˆ’é¥®é£Ÿ               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         â”‚                           â”‚
â”‚      è¡¨å• + ç»“æœ         â”‚       å‚è€ƒä¿¡æ¯            â”‚
â”‚                         â”‚                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   åŸç†è¯´æ˜                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   SEO å†…å®¹                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç»“æœå¡ç‰‡è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸŸ¢ é«˜ç¢³æ—¥ (è®­ç»ƒæ—¥)                      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  çƒ­é‡: 2400 åƒå¡                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ è›‹ç™½è´¨  â”‚  ç¢³æ°´   â”‚  è„‚è‚ª   â”‚        â”‚
â”‚  â”‚  140g   â”‚  300g   â”‚  67g    â”‚        â”‚
â”‚  â”‚  23%    â”‚  50%    â”‚  27%    â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## SEO é…ç½®

### JSON-LD ç»“æ„åŒ–æ•°æ®

```json
{
  "@type": "SoftwareApplication",
  "name": "ç¢³å¾ªç¯å‡è„‚è®¡ç®—å™¨",
  "applicationCategory": "HealthApplication",
  "description": "åŸºäºKatch-McArdleå…¬å¼çš„ç¢³å¾ªç¯é¥®é£Ÿè®¡ç®—å™¨..."
}
```

### FAQ ç»“æ„åŒ–æ•°æ®

1. ä»€ä¹ˆæ˜¯ç¢³å¾ªç¯é¥®é£Ÿï¼Ÿ
2. ç¢³å¾ªç¯é€‚åˆä»€ä¹ˆäººï¼Ÿ
3. é«˜ç¢³æ—¥å’Œä½ç¢³æ—¥æ€ä¹ˆå®‰æ’ï¼Ÿ

## éœ€è¦æ›´æ–°çš„ç°æœ‰æ–‡ä»¶

1. **å¯¼èˆªé…ç½®** - `src/lib/config/navigation.ts`
2. **é¦–é¡µå·¥å…·åˆ—è¡¨** - `src/app/page.tsx`
3. **å›½é™…åŒ–æ–‡æœ¬** - `src/lib/i18n/zh.ts`
4. **é¦–é¡µå›¾æ ‡** - `src/components/home/feature-grid.tsx`
5. **ç§»åŠ¨ç«¯å¯¼èˆª** - `src/components/layout/mobile-nav.tsx`
